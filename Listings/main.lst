


ARM Macro Assembler    Page 1 


    1 00000000         ;Se asignan etiquetas para las constantes de 0 y 1 que s
                       e usaran para mostrar el valor de los outputs que irán a
                        las alarmas
    2 00000000         
    3 00000000 00000001 
                       TRUE    EQU              1
    4 00000000 00000000 
                       FALSE   EQU              0
    5 00000000         
    6 00000000         ; Se asignan etiquetas para los espacios de memoria RAM 
                       donde se almacenaran los ouputs del sistema
    7 00000000         ; La memoria RAM comienza en la dirección 0x20000000
    8 00000000         ;Cada dirección de memoria apunta a un bloque de 4 bytes
                        de tamaño
    9 00000000         
   10 00000000 20000000 
                       RXPIN   EQU              0x20000000  ; Etiqueta del espa
                                                            cio de memoria dond
                                                            e se asigna el pin 
                                                            RX del ESP8266
   11 00000000 20000004 
                       TXPIN   EQU              0x20000004  ; Etiqueta del espa
                                                            cio de memoria dond
                                                            e se asigna el pin 
                                                            TX del ESP8266
   12 00000000 20000008 
                       BRS     EQU              0X20000008  ; Etiqueta del espa
                                                            cio de memoria dond
                                                            e se asigna el Baud
                                                             Rate Serial
   13 00000000         
   14 00000000         
   15 00000000         
   16 00000000         
   17 00000000         ;Código del programa principal
   18 00000000         
   19 00000000                 AREA             Main, CODE, READONLY
   20 00000000                 ENTRY
   21 00000000                 EXPORT           __main
   22 00000000         
   23 00000000         __main
   24 00000000         
   25 00000000         ; Conjunto de Branches que representan el esqueleto del 
                       código
   26 00000000         
   27 00000000 F000 F808       BL               SMW         ; Branch de la subr
                                                            utina SMW = Setup d
                                                            el Módulo de Wifi
   28 00000004 F000 F81C 
                       INF     BL               GDC         ; Branch de la subr
                                                            utina GDC = Get de 
                                                            los Datos de las Cá
                                                            maras
   29 00000008 F000 F81C       BL               PDS         ; Branch de la subr
                                                            utina PDS = Post de
                                                             los Datos al Serve
                                                            r
   30 0000000C F000 F81C       BL               GMA         ; Branch de la subr
                                                            utina GMA = Get del



ARM Macro Assembler    Page 2 


                                                             Mensaje y de la Al
                                                            arma
   31 00000010 F000 F81C       BL               EMA         ; Branch de la subr
                                                            utina EMA = Escritu
                                                            ra del Mensaje en e
                                                            l LCD y activar las
                                                             Alarmas
   32 00000014         
   33 00000014         
   34 00000014         ; Paso #0
   35 00000014         ; Subrutina que se encarga de hacer el setup de los pine
                       s y las condiciones requeridas por el módulo de Wifi ESP
                       8266
   36 00000014         
   37 00000014         ;Se establecen los pines en que va a funcionar el módulo
                       
   38 00000014 F04F 0602 
                       SMW     MOV              R6,#2
   39 00000018 F04F 0703       MOV              R7,#3
   40 0000001C F04F 5800       LDR              R8,=RXPIN   ; RX se establce en
                                                             el pin 2
   41 00000020 F8C8 6000       STR              R6,[R8]
   42 00000024 F8DF 802C       LDR              R8,=TXPIN   ; TX se establece e
                                                            n el pin 3 
   43 00000028 F8C8 7000       STR              R7,[R8]
   44 0000002C         ;Se establece el Baudrate de la comunicación serial 
   45 0000002C F44F 5616       MOV              R6,#9600
   46 00000030 4F09            LDR              R7,=BRS     ; Se inicializa la 
                                                            velocidad de comuni
                                                            cación serial en 96
                                                            00
   47 00000032 603E            STR              R6,[R7]
   48 00000034         ;Se hace un delay de 2 milisegundos (En este caso se esp
                       eran 2 tiempos)
   49 00000034 F04F 0602       MOV              R6,#2
   50 00000038 B116    DL2     CBZ              R6,GDC      ;Básicamente lo sac
                                                            a del loop cuando R
                                                            6(contador del dela
                                                            y en este caso) sea
                                                             cero
   51 0000003A F1A6 0601       SUB              R6,R6,#1
   52 0000003E E7FB            B                DL2
   53 00000040         
   54 00000040         
   55 00000040         
   56 00000040         ; Paso #1  
   57 00000040         ; Subrutina que se encarga de hacer el request GET de lo
                       s datos de la cámara térmica y de la cámara de distancia
                       
   58 00000040         
   59 00000040         
   60 00000040 F04F 0C01 
                       GDC     MOV              R12,1
   61 00000044         
   62 00000044         ;Paso #2
   63 00000044         ; Subrutina que se encarga de hacer el request POST de l
                       os datos obtenidos de las cámaras al Server del sistema
   64 00000044         
   65 00000044 F04F 0601 



ARM Macro Assembler    Page 3 


                       PDS     MOV              R6,1
   66 00000048         
   67 00000048         ;Paso #3
   68 00000048         ; Subrutina que se encarga de hacer el request GET al Se
                       rver del Mensaje de que se proyectará en el LCD y del có
                       digo de activación de las alarmas
   69 00000048         
   70 00000048 F04F 0701 
                       GMA     MOV              R7,1
   71 0000004C         
   72 0000004C         
   73 0000004C         ; Paso #4
   74 0000004C         ; Subrutina que se encarga de mandar al LCD el mensaje o
                       btenido através del servidor y de activar o no las alarm
                       as dependiendo de lo obtenido por el Server
   75 0000004C         
   76 0000004C F04F 0800 
                       EMA     MOV              R8,0
   77 00000050 F7FF FFD8       BL               INF         ; Se regresa al Bra
                                                            nch INF para genera
                                                            r un loop infinito
   78 00000054         
   79 00000054                 END
              20000004 
              20000008 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interw
ork --depend=.\objects\main.d -o.\objects\main.o -I.\RTE\_Cortex-M3 -IC:\Users\
User\AppData\Local\Arm\Packs\ARM\CMSIS\5.7.0\CMSIS\Core\Include -IC:\Users\User
\AppData\Local\Arm\Packs\ARM\CMSIS\5.7.0\Device\ARM\ARMCM3\Include --predefine=
"__EVAL SETA 1" --predefine="__MICROLIB SETA 1" --predefine="__UVISION_VERSION 
SETA 529" --predefine="_RTE_ SETA 1" --predefine="ARMCM3 SETA 1" --list=.\listi
ngs\main.lst main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

DL2 00000038

Symbol: DL2
   Definitions
      At line 50 in file main.s
   Uses
      At line 52 in file main.s
Comment: DL2 used once
EMA 0000004C

Symbol: EMA
   Definitions
      At line 76 in file main.s
   Uses
      At line 31 in file main.s
Comment: EMA used once
GDC 00000040

Symbol: GDC
   Definitions
      At line 60 in file main.s
   Uses
      At line 28 in file main.s
      At line 50 in file main.s

GMA 00000048

Symbol: GMA
   Definitions
      At line 70 in file main.s
   Uses
      At line 30 in file main.s
Comment: GMA used once
INF 00000004

Symbol: INF
   Definitions
      At line 28 in file main.s
   Uses
      At line 77 in file main.s
Comment: INF used once
Main 00000000

Symbol: Main
   Definitions
      At line 19 in file main.s
   Uses
      None
Comment: Main unused
PDS 00000044

Symbol: PDS
   Definitions
      At line 65 in file main.s
   Uses
      At line 29 in file main.s
Comment: PDS used once
SMW 00000014




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: SMW
   Definitions
      At line 38 in file main.s
   Uses
      At line 27 in file main.s
Comment: SMW used once
__main 00000000

Symbol: __main
   Definitions
      At line 23 in file main.s
   Uses
      At line 21 in file main.s
Comment: __main used once
9 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

BRS 20000008

Symbol: BRS
   Definitions
      At line 12 in file main.s
   Uses
      At line 46 in file main.s
Comment: BRS used once
FALSE 00000000

Symbol: FALSE
   Definitions
      At line 4 in file main.s
   Uses
      None
Comment: FALSE unused
RXPIN 20000000

Symbol: RXPIN
   Definitions
      At line 10 in file main.s
   Uses
      At line 40 in file main.s
Comment: RXPIN used once
TRUE 00000001

Symbol: TRUE
   Definitions
      At line 3 in file main.s
   Uses
      None
Comment: TRUE unused
TXPIN 20000004

Symbol: TXPIN
   Definitions
      At line 11 in file main.s
   Uses
      At line 42 in file main.s
Comment: TXPIN used once
5 symbols
351 symbols in table
